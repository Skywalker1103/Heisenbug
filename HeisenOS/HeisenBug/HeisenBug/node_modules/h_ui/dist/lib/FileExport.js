!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("h_ui/dist/lib/util/tools.js"),require("h_ui/dist/lib/util/global.js"),require("h_ui/dist/lib/mixins/locale.js"),require("h_ui/dist/lib/Button.js"),require("h_ui/dist/lib/Message.js"),require("xlsx")):"function"==typeof define&&define.amd?define("h_ui/lib",["h_ui/dist/lib/util/tools.js","h_ui/dist/lib/util/global.js","h_ui/dist/lib/mixins/locale.js","h_ui/dist/lib/Button.js","h_ui/dist/lib/Message.js","xlsx"],t):"object"==typeof exports?exports["h_ui/lib"]=t(require("h_ui/dist/lib/util/tools.js"),require("h_ui/dist/lib/util/global.js"),require("h_ui/dist/lib/mixins/locale.js"),require("h_ui/dist/lib/Button.js"),require("h_ui/dist/lib/Message.js"),require("xlsx")):e["h_ui/lib"]=t(e["h_ui/dist/lib/util/tools.js"],e["h_ui/dist/lib/util/global.js"],e["h_ui/dist/lib/mixins/locale.js"],e["h_ui/dist/lib/Button.js"],e["h_ui/dist/lib/Message.js"],e.xlsx)}(window,(function(e,t,n,r,o,i){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/lib/",n(n.s=905)}({0:function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},1:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},10:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},11:function(e,t,n){var r=n(5),o=n(14);e.exports=n(2)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},119:function(e,t){e.exports=r},12:function(e,t,n){var r=n(6);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},13:function(e,t,n){var r=n(50),o=n(18);e.exports=function(e){return r(o(e))}},14:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},16:function(e,t,n){var r=n(27);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},17:function(e,t,n){var r=n(6);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},18:function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},19:function(e,t,n){var r=n(45),o=n(31);e.exports=Object.keys||function(e){return r(e,o)}},199:function(e,t){e.exports=o},2:function(e,t,n){e.exports=!n(7)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},20:function(e,t,n){var r=n(18);e.exports=function(e){return Object(r(e))}},21:function(t,n){t.exports=e},22:function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},23:function(e,t){e.exports=!0},24:function(e,t,n){var r=n(6),o=n(1).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},25:function(e,t,n){e.exports=!n(2)&&!n(7)((function(){return 7!=Object.defineProperty(n(24)("div"),"a",{get:function(){return 7}}).a}))},27:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},279:function(e,t,n){var r=n(2),o=n(19),i=n(13),u=n(28).f;e.exports=function(e){return function(t){for(var n,a=i(t),s=o(a),f=s.length,c=0,l=[];f>c;)n=s[c++],r&&!u.call(a,n)||l.push(e?[n,a[n]]:a[n]);return l}}},28:function(e,t){t.f={}.propertyIsEnumerable},29:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},3:function(e,t,n){var r=n(1),o=n(0),i=n(16),u=n(11),a=n(10),s=function(e,t,n){var f,c,l,h=e&s.F,p=e&s.G,d=e&s.S,v=e&s.P,b=e&s.B,y=e&s.W,x=p?o:o[t]||(o[t]={}),g=x.prototype,m=p?r:d?r[t]:(r[t]||{}).prototype;for(f in p&&(n=t),n)(c=!h&&m&&void 0!==m[f])&&a(x,f)||(l=c?m[f]:n[f],x[f]=p&&"function"!=typeof m[f]?n[f]:b&&c?i(l,r):y&&m[f]==l?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(l):v&&"function"==typeof l?i(Function.call,l):l,v&&((x.virtual||(x.virtual={}))[f]=l,e&s.R&&g&&!g[f]&&u(g,f,l)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},30:function(e,t,n){var r=n(0),o=n(1),i="__core-js_shared__",u=o[i]||(o[i]={});(e.exports=function(e,t){return u[e]||(u[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(23)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},31:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},32:function(e,n){e.exports=t},33:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},332:function(e,t,n){e.exports=n(333)},333:function(e,t,n){n(334),e.exports=n(0).Object.values},334:function(e,t,n){var r=n(3),o=n(279)(!1);r(r.S,"Object",{values:function(e){return o(e)}})},34:function(e,t,n){var r=n(30)("keys"),o=n(22);e.exports=function(e){return r[e]||(r[e]=o(e))}},4:function(e,t,n){"use strict";function r(e,t,n,r,o,i,u,a){var s,f="function"==typeof e?e.options:e;if(t&&(f.render=t,f.staticRenderFns=n,f._compiled=!0),r&&(f.functional=!0),i&&(f._scopeId="data-v-"+i),u?(s=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(u)},f._ssrRegister=s):o&&(s=a?function(){o.call(this,(f.functional?this.parent:this).$root.$options.shadowRoot)}:o),s)if(f.functional){f._injectStyles=s;var c=f.render;f.render=function(e,t){return s.call(t),c(e,t)}}else{var l=f.beforeCreate;f.beforeCreate=l?[].concat(l,s):[s]}return{exports:e,options:f}}n.d(t,"a",(function(){return r}))},42:function(e,t,n){var r=n(29),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},45:function(e,t,n){var r=n(10),o=n(13),i=n(67)(!1),u=n(34)("IE_PROTO");e.exports=function(e,t){var n,a=o(e),s=0,f=[];for(n in a)n!=u&&r(a,n)&&f.push(n);for(;t.length>s;)r(a,n=t[s++])&&(~i(f,n)||f.push(n));return f}},481:function(e,t,n){"use strict";n.r(t);var r=n(482),o=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t.default=o.a},482:function(e,t,n){"use strict";var r=n(8);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(56)),i=r(n(332)),u=r(n(119)),a=r(n(686)),s=r(n(49)),f=n(21),c=n(907),l=r(n(199)),h={mixins:[s.default],data:function(){return{rebuildData:[],colsConfig:[]}},components:{hButton:u.default},props:{fileName:{type:String,default:"test"},fileType:{type:String,validator:function(e){return(0,f.oneOf)(e,["xls","xlsx","csv"])},default:"xls"},sheetType:{type:String,validator:function(e){return(0,f.oneOf)(e,["self","table"])},default:"self"},sheetNames:{type:Array,default:function(){return[]}},sheetTitleNames:{type:Array,default:function(){return[]}},sheetHeaders:{type:Array,default:function(){return[]}},sheetTableData:{type:Array,default:function(){return[]}},sheetSelfHeaders:{type:Array,default:function(){return[]}},sheetSelfData:{type:Array,default:function(){return[]}},noTipText:{type:String,default:"暂无导出数据"},numberFormat:{type:Boolean,default:!1},beforeExport:Function,beforeSave:Function},watch:{sheetHeaders:{handler:function(e){this.rebuildData=this.makeData()},deep:!0},sheetTableData:{handler:function(e){this.rebuildData=this.makeData()},deep:!0},sheetSelfData:{handler:function(e){this.rebuildData=this.makeData()},deep:!0}},methods:{makeData:function(){var e=[];if("table"==this.sheetType&&this.sheetTableData){if(this.sheetNames.length>0||this.sheetHeaders.length>0||this.sheetTableData.length>0)for(var t=Math.max(this.sheetNames.length,this.sheetHeaders.length,this.sheetTableData.length),n=0;n<t;n++){var r=this.makeSheetHeaderData(n),o=this.makeSheetTableData(n),i=[];r.length>0&&i.push(r),i=o.length>0?i.concat(o):i,e.push(i)}}else if("self"==this.sheetType&&this.sheetSelfData)if(this.sheetSelfHeaders.length>0)for(var u=Math.max(this.sheetSelfHeaders.length,this.sheetSelfData.length),a=0;a<u;a++){var s,f=this.sheetSelfHeaders[a]?this.sheetSelfHeaders[a]:[],c=this.sheetSelfData[a]?this.sheetSelfData[a]:[];s=f.concat(c),e.push(s)}else e=this.sheetSelfData;return e},makeSheetHeaderData:function(e){var t=this.sheetHeaders[e]?this.sheetHeaders[e]:[],n=[],r={};return t.length>0&&(t.forEach((function(e,t){n.push(e.title?e.title:e.key?e.key:"");var o=(0,c.letterConversion)(t+1);r[o]=e.z})),this.colsConfig.push(r),r=null),n},makeSheetTableData:function(e){var t=[],n=this.sheetTableData[e]?this.sheetTableData[e]:[],r=this.sheetHeaders[e]?this.sheetHeaders[e]:[];return n.length>0&&(r.length>0?n.forEach((function(e){t.push(r.map((function(t,n){return t.key&&t.exportRender?t.exportRender(e[t.key],e):void 0!==e[t.key]?e[t.key]:""})))})):(t.push((0,o.default)(n[0])),n.forEach((function(e){t.push((0,i.default)(e))})))),t},makeMergesArray:function(e){var t=[];e.forEach((function(e,n){for(var r=0;r<e.length;r++){var o={id:e[r],coordinate:[{x:r,y:n}]};t.push(o)}}));var n=(0,c.filterDuplicate)(t),r=[];return n.forEach((function(e){var t={},n=e.coordinate.length;if(n>1){t.s={c:e.coordinate[0].x,r:e.coordinate[0].y,alignment:{horizontal:"center",vertical:"center"}};for(var o=n-1;o>0;o--)if(e.coordinate[0].x===e.coordinate[o].x||e.coordinate[0].y===e.coordinate[o].y){t.e={c:e.coordinate[o].x,r:e.coordinate[o].y};break}r.push(t)}})),r},exportFile:function(){var e=this;if(!this.beforeExport||this.beforeExport())if(this.rebuildData.length>0){var t={bookType:this.fileType,bookSST:!1,type:"binary"},n={SheetNames:[],Sheets:{},Props:{}};this.rebuildData.forEach((function(t,r){var o={};if(e.sheetTitleNames&&e.sheetTitleNames[r])(o=a.default.utils.json_to_sheet(t)).A1={t:"s",v:e.sheetTitleNames[r]},o["!merges"]=[{s:{c:0,r:0,alignment:{horizontal:"center",vertical:"center"}},e:{c:t&&t[0]&&t[0].length-1>0?t[0].length-1:0,r:0}}];else{o=a.default.utils.aoa_to_sheet(t);var i=e.sheetSelfHeaders[r]?e.sheetSelfHeaders[r]:[];o["!merges"]=e.makeMergesArray(i)}if("table"===e.sheetType&&e.numberFormat)for(var u in o)if(o.hasOwnProperty(u)){var s=u.replace(/(\d+)/,"");if(!e.colsConfig[r])continue;var f=e.colsConfig[r][s];"n"===o[u].t&&f&&(o[u].z=f)}var c=e.sheetNames&&e.sheetNames[r]?e.sheetNames[r]:"Sheet"+r;n.SheetNames[r]=c,n.Sheets[c]=o}));var r=this.fileName+"."+("biff2"==t.bookType?"xls":t.bookType),o=new Blob([this.s2ab(a.default.write(n,t))],{type:"application/octet-stream"});this.beforeSave&&!this.beforeSave(o)||this.saveAs(o,r),this.$emit("on-success")}else l.default.info(this.noTipText)},s2ab:function(e){if("undefined"!=typeof ArrayBuffer){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}for(var o=new Array(e.length),i=0;i!=e.length;++i)o[i]=255&e.charCodeAt(i);return o},saveAs:function(e,t){var n=document.createElement("a");n.download=t||"下载",n.href=URL.createObjectURL(e),n.click(),setTimeout((function(){URL.revokeObjectURL(e)}),100)}},created:function(){this.rebuildData=this.makeData()}};t.default=h},49:function(e,t){e.exports=n},5:function(e,t,n){var r=n(12),o=n(25),i=n(17),u=Object.defineProperty;t.f=n(2)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return u(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},50:function(e,t,n){var r=n(33);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},56:function(e,t,n){e.exports=n(77)},58:function(e,t,n){var r=n(3),o=n(0),i=n(7);e.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],u={};u[e]=t(n),r(r.S+r.F*i((function(){n(1)})),"Object",u)}},6:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},65:function(e,t,n){var r=n(29),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):i(e,t)}},67:function(e,t,n){var r=n(13),o=n(42),i=n(65);e.exports=function(e){return function(t,n,u){var a,s=r(t),f=o(s.length),c=i(u,f);if(e&&n!=n){for(;f>c;)if((a=s[c++])!=a)return!0}else for(;f>c;c++)if((e||c in s)&&s[c]===n)return e||c||0;return!e&&-1}}},686:function(e,t){e.exports=i},7:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},731:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{click:e.exportFile}},[e._t("default",[n("h-button",{attrs:{type:"ghost"}},[e._v(e._s(e.t("i.fileExport.exportFile")))])])],2)},o=[];r._withStripped=!0},77:function(e,t,n){n(78),e.exports=n(0).Object.keys},78:function(e,t,n){var r=n(20),o=n(19);n(58)("keys",(function(){return function(e){return o(r(e))}}))},8:function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},85:function(e,t,n){e.exports=n(91)},905:function(e,t,n){"use strict";var r=n(8);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(906)),i=n(32);o.default.install=function(e,t){(0,i.setGlobal)(e,t),e.component("HFileExport",o.default),e.component("FileExport",o.default)};var u=o.default;t.default=u},906:function(e,t,n){"use strict";n.r(t);var r=n(731),o=n(481);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(4),a=Object(u.a)(o.default,r.a,r.b,!1,null,null,null);t.default=a.exports},907:function(e,t,n){"use strict";var r=n(8);Object.defineProperty(t,"__esModule",{value:!0}),t.filterDuplicate=function(e){var t=JSON.parse((0,o.default)(e)),n=[];t.forEach((function(e){n.push(e.id)}));var r=[],i=[];return n.forEach((function(e,n){var o={id:"",coordinate:[]};r.indexOf(e)>-1?i.find((function(t){return t.id===e})).coordinate.push(t[n].coordinate[0]):(o.id=e,o.coordinate.push(t[n].coordinate[0]),r.push(e),i.push(o))})),i},t.letterConversion=function(e){var t=e,n=[];for(;t;){var r=t%26;r||(r=26,--t),n.push((0,i.default)(r+64)),t=~~(t/26)}return n.reverse().join("")};var o=r(n(85)),i=r(n(908))},908:function(e,t,n){e.exports=n(909)},909:function(e,t,n){n(910),e.exports=n(0).String.fromCodePoint},91:function(e,t,n){var r=n(0),o=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},910:function(e,t,n){var r=n(3),o=n(65),i=String.fromCharCode,u=String.fromCodePoint;r(r.S+r.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,u=0;r>u;){if(t=+arguments[u++],o(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?i(t):i(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})}})}));